<!DOCTYPE html>
<html>
<head>
    <title>Keyboard and Mouse Tracking Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <div class="container">
        <!-- Keyboard Usage by Day of the Week -->
        <div class="chart-section">
            <h1>Keyboard Usage by Day of the Week</h1>
            <!-- Filter Section -->
            <div class="filter-section">
                <label for="monthFilter">Filter by Month:</label>
                <select id="monthFilter" onchange="window.location.href = '?month=' + this.value;">
                    <option value="">All Months</option>
                    {% for month in unique_months %}
                        <option value="{{ month.month }}" {% if selected_month == month.month %}selected{% endif %}>
                            {{ month.month }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="chart-container">
                <canvas id="keyboardUsageChart"></canvas>
            </div>
        </div>

        <!-- Typing Pattern Analysis -->
        <div class="typing-pattern-section">
            <h2>Typing Pattern Analysis</h2>
            <div class="metrics">
                <div>
                    <h3>Typing Speed</h3>
                    <p>{{ typing_speed|floatformat:2 }} CPM</p>
                </div>
                <div>
                    <h3>Average Key Interval</h3>
                    <p>{{ average_interval|floatformat:2 }} seconds</p>
                </div>
            </div>
            <div class="common-combinations">
                <h3>Common Key Combinations</h3>
                <ul>
                    {% for combination, count in common_combinations.items %}
                        <li>{{ combination }}: {{ count }} times</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Keyboard Heatmap -->
        <div class="chart-section">
            <h1>Keyboard Heatmap</h1>
            <div class="keyboard">
                <!-- First Row: Numbers -->
                <div class="row">
                    <div class="key" data-key="1">1<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="2">2<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="3">3<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="4">4<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="5">5<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="6">6<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="7">7<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="8">8<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="9">9<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="0">0<span class="tooltip">Clicks: 0</span></div>
                </div>

                <!-- Second Row: Letters (Q-P) -->
                <div class="row">
                    <div class="key" data-key="q">q<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="w">w<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="e">e<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="r">r<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="t">t<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="y">y<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="u">u<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="i">i<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="o">o<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="p">p<span class="tooltip">Clicks: 0</span></div>
                </div>

                <!-- Third Row: Letters (A-L) -->
                <div class="row">
                    <div class="key" data-key="a">a<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="s">s<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="d">d<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="f">f<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="g">g<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="h">h<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="j">j<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="k">k<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="l">l<span class="tooltip">Clicks: 0</span></div>
                </div>

                <!-- Fourth Row: Letters (Z-M) -->
                <div class="row">
                    <div class="key" data-key="z">z<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="x">x<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="c">c<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="v">v<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="b">b<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="n">n<span class="tooltip">Clicks: 0</span></div>
                    <div class="key" data-key="m">m<span class="tooltip">Clicks: 0</span></div>
                </div>
            </div>
        </div>
    </div>

    
</body>








<style>
    /* General Styles */
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f4f4f9;
        margin: 0;
        padding: 20px;
        color: #333;
    }

    h1 {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Chart Section */
    .chart-section {
        margin-bottom: 40px;
    }

    .chart-container {
        width: 100%;
        height: 500px; /* Increased height for the chart */
        margin: 0 auto;
        position: relative;
    }

    /* Filter Section */
    .filter-section {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 20px;
    }

    .filter-section select {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: #fff;
        cursor: pointer;
    }

    /* Typing Pattern Analysis Section */
    .typing-pattern-section {
        margin-bottom: 40px;
    }

    .typing-pattern-section h2 {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 20px;
    }

    .typing-pattern-section .metrics {
        display: flex;
        justify-content: space-around;
        margin-bottom: 20px;
    }

    .typing-pattern-section .metrics div {
        text-align: center;
        background: #f0f0f0;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        width: 30%;
    }

    .typing-pattern-section .metrics div h3 {
        margin-bottom: 10px;
        color: #2c3e50;
    }

    .typing-pattern-section .metrics div p {
        font-size: 18px;
        color: #333;
    }

    .typing-pattern-section .common-combinations {
        text-align: center;
    }

    .typing-pattern-section .common-combinations h3 {
        margin-bottom: 10px;
        color: #2c3e50;
    }

    .typing-pattern-section .common-combinations ul {
        list-style-type: none;
        padding: 0;
    }

    .typing-pattern-section .common-combinations ul li {
        background: #f0f0f0;
        padding: 10px;
        margin: 5px 0;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Keyboard Heatmap Section */
    .keyboard {
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 20px;
        background: #f0f0f0;
        border-radius: 10px;
        width: fit-content;
        margin: 0 auto;
    }

    .row {
        display: flex;
        gap: 10px;
        justify-content: center;
    }

    .key {
        padding: 20px;
        background: #e0e0e0;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: background 0.3s, transform 0.2s;
        min-width: 50px;
        font-size: 16px;
        font-weight: bold;
        color: #333;
        position: relative; /* Required for tooltip positioning */
    }

    .key:hover {
        background: #d0d0d0;
        transform: scale(1.05);
    }

    /* Tooltip Styles */
    .key .tooltip {
        visibility: hidden;
        width: 80px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 5px;
        padding: 5px;
        position: absolute;
        z-index: 1;
        bottom: 125%; /* Position above the key */
        left: 50%;
        margin-left: -40px; /* Center the tooltip */
        opacity: 0;
        transition: opacity 0.3s;
    }

    .key:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .key {
            padding: 15px;
            min-width: 40px;
            font-size: 14px;
        }

        .row {
            gap: 5px;
        }

        .chart-container {
            height: 300px; /* Adjust height for smaller screens */
        }

        .typing-pattern-section .metrics {
            flex-direction: column;
            align-items: center;
        }

        .typing-pattern-section .metrics div {
            width: 80%;
            margin-bottom: 20px;
        }
    }
</style>



<script>
    // Keyboard Usage by Day of the Week Chart
    const keyPressesByDay = JSON.parse('{{ key_presses_by_day|escapejs }}');
    const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    let data = daysOfWeek.map(day => keyPressesByDay[day] || 0);

    const ctx = document.getElementById('keyboardUsageChart').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: daysOfWeek,
            datasets: [{
                label: 'Key Presses',
                data: data,
                backgroundColor: 'rgba(75, 192, 192, 0.6)', // More vibrant color
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 2, // Thicker border
                borderRadius: 5, // Rounded bars
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, // Allow custom height and width
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Number of Key Presses',
                        font: {
                            size: 14,
                            weight: 'bold',
                        }
                    },
                    grid: {
                        color: '#e0e0e0', // Light grid lines
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Day of the Week',
                        font: {
                            size: 14,
                            weight: 'bold',
                        }
                    },
                    grid: {
                        display: false, // Hide vertical grid lines
                    }
                }
            },
            plugins: {
                legend: {
                    display: false, // Hide the legend
                }
            }
        }
    });

    // Filter Event Listener
    document.getElementById('monthFilter').addEventListener('change', updateChart);

    // Function to update the chart based on filters
    function updateChart() {
        const month = document.getElementById('monthFilter').value;

        // Simulate fetching new data based on filters (replace with actual API call)
        const newData = daysOfWeek.map(day => {
            // Replace this with logic to fetch data for the selected month
            return Math.floor(Math.random() * 100); // Random data for demonstration
        });

        // Update the chart
        chart.data.datasets[0].data = newData;
        chart.update();
    }

    // Keyboard Heatmap
    const keyPressCounts = JSON.parse('{{ key_press_counts|escapejs }}');

    function updateKeyColor(keyElement, count) {
        const intensity = Math.min(count / 200, 1);
        const red = Math.floor(255 * intensity);
        const green = Math.floor(255 * (1 - intensity));
        keyElement.style.backgroundColor = `rgb(${red}, ${green}, 0)`;

        // Update the tooltip text
        const tooltip = keyElement.querySelector('.tooltip');
        tooltip.textContent = `Clicks: ${count}`;
    }

    document.querySelectorAll('.key').forEach(keyElement => {
        const key = keyElement.getAttribute('data-key');
        const count = keyPressCounts[key] || 0;
        updateKeyColor(keyElement, count);
    });
</script>
</html>